{
    "path": "artifacts/li-fi.pdf",
    "project_info": {
        "url": "https://github.com/lifinance/contracts",
        "commit_id": "7a4a667",
        "address": "n/a",
        "chain": "n/a",
        "compiler_version": [
            "n/a"
        ],
        "project_path": {
            "contracts": "contracts/li-fi/contracts"
        }
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-665"
                ],
                "3": [
                    "CWE-1419"
                ]
            },
            "title": "Potential Unexpected Collision Caused by Unmapped Address of LibStorages",
            "description": "No predefined addresses for newOwner, LibStorage s, and LibStorage ls, which can cause collisions in slot 0.",
            "severity": "high",
            "location": "src/Facets/DexManagerFacet.sol, src/Helpers/Swapper.sol"
        },
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-666"
                ]
            },
            "title": "jlength Not Updated After a DEX is Removed From the Storage",
            "description": "jlength is never updated after a DEX is removed from storage using _removeDex(j).",
            "severity": "medium",
            "location": "src/Facets/DexManagerFacet.sol"
        },
        {
            "id": 2,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-662"
                ],
                "3": [
                    "CWE-820"
                ]
            },
            "title": "Diamond Facet Upgrade Could Lead to Inconsistency",
            "description": "Upgrades of new facets are not done in a single transaction, which can lead to inconsistencies.",
            "severity": "low",
            "location": "src/Libraries/LibDiamond.sol, src/Facets/DiamondCutFacet.sol"
        },
        {
            "id": 3,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-431"
                ]
            },
            "title": "Events Should Be Emitted In Critical Operations",
            "description": "Certain functions do not emit events when initialized or critical changes are made.",
            "severity": "low",
            "location": "src/Facets/HopFacet.sol, src/Facets/HyphenFacet.sol, src/Facets/NXTPFacet.sol"
        },
        {
            "id": 4,
            "category": {
                "1": [
                    "CWE-284"
                ],
                "2": [
                    "CWE-287"
                ],
                "3": [
                    "CWE-306"
                ],
                "4": [
                    "CWE-288"
                ],
                "5": [
                    "CWE-1299"
                ]
            },
            "title": "Highly Dependent On Offchain Components",
            "description": "Input parameters are generated by offchain components which can be hacked or DDoSed.",
            "severity": "info",
            "location": "All bridging facets"
        },
        {
            "id": 5,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1068"
                ]
            },
            "title": "Clone-And-Own",
            "description": "Cloned code from another repository without proper comments and modifications tracking.",
            "severity": "info",
            "location": "src/Facets/DiamondCutFacet.sol, src/Facets/DiamondLoupeFacet.sol, src/Libraries/LibDiamond.sol"
        },
        {
            "id": 6,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1068"
                ]
            },
            "title": "Two Versions Of Swapper.sol",
            "description": "Two files named Swapper.sol with similar functionality, which can lead to confusion and unexpected behavior.",
            "severity": "info",
            "location": "src/Facets/Swapper.sol, src/Helpers/Swapper.sol"
        },
        {
            "id": 7,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ]
            },
            "title": "Missing Input Check",
            "description": "Constructor in LiFiDiamond.sol does not check if address _contractOwner and address _diamondCutFacet are non-zero addresses.",
            "severity": "info",
            "location": "src/LiFiDiamond.sol"
        },
        {
            "id": 8,
            "category": {
                "1": [
                    "CWE-284"
                ],
                "2": [
                    "CWE-269"
                ]
            },
            "title": "Privileged Roles and Ownership",
            "description": "Centralization of power needs to be made clear to users, especially depending on the level of privilege the contract allows to the owner.",
            "severity": "info",
            "location": "All contracts"
        },
        {
            "id": 9,
            "category": {
                "1": [
                    "CWE-710"
                ]
            },
            "title": "Unlocked Pragma",
            "description": "Every Solidity file specifies an unlocked pragma, which can lead to unexpected behavior in the future.",
            "severity": "info",
            "location": "All contracts"
        }
    ]
}